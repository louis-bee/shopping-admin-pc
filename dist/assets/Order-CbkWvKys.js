import{r as c,x as H,h as O,ag as b,a as T,ac as V,F as a,j as e,C as E,I as g,B as d,R as j,ad as S}from"./index-DbKjKfQh.js";import{i as M}from"./error-BX8EiPuL.js";import{F as A,T as w}from"./index-wdfp5rx4.js";import{S as B}from"./index-Bxnr9kBO.js";var L={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 192a32 32 0 0132 32v160h174.81a32 32 0 0126.68 14.33l113.19 170.84a32 32 0 015.32 17.68V672a32 32 0 01-32 32h-96c0 70.7-57.3 128-128 128s-128-57.3-128-128H384c0 70.7-57.3 128-128 128s-128-57.3-128-128H96a32 32 0 01-32-32V224a32 32 0 0132-32zM256 640a64 64 0 000 128h1.06A64 64 0 00256 640m448 0a64 64 0 000 128h1.06A64 64 0 00704 640M576 256H128v384h17.12c22.13-38.26 63.5-64 110.88-64 47.38 0 88.75 25.74 110.88 64H576zm221.63 192H640v145.12A127.43 127.43 0 01704 576c47.38 0 88.75 25.74 110.88 64H896v-43.52zM500 448a12 12 0 0112 12v40a12 12 0 01-12 12H332a12 12 0 01-12-12v-40a12 12 0 0112-12zM308 320a12 12 0 0112 12v40a12 12 0 01-12 12H204a12 12 0 01-12-12v-40a12 12 0 0112-12z"}}]},name:"truck",theme:"outlined"},R=function(i,n){return c.createElement(H,O({},i,{ref:n,icon:L}))},$=c.forwardRef(R);function q(t){return b({url:"order/getOrderListBySeller",method:"POST",data:t})}function K(t){return b({url:"order/delivery",method:"POST",data:t})}const Q=()=>{const t={2:e.jsx(w,{color:"warning",children:"未发货"}),3:e.jsx(w,{color:"success",children:"已完成"})},i=[{title:"订单号",dataIndex:"id"},{title:"封面",dataIndex:"images",width:100,render:s=>e.jsx("img",{src:`https://api.example.com/uploads/${s[0]}`||M,width:60,height:60,alt:""})},{title:"商品名",dataIndex:"goodsName",width:200},{title:"销售人员id",dataIndex:"sellerId"},{title:"用户id",dataIndex:"consumerId"},{title:"用户名",dataIndex:"userName"},{title:"数量",dataIndex:"number"},{title:"交易时间",dataIndex:"time"},{title:"状态",dataIndex:"status",render:s=>t[s]},{title:"发货",render:s=>e.jsx(B,{size:"middle",children:e.jsx(d,{type:"primary",shape:"circle",disabled:s.status===3,icon:e.jsx($,{}),onClick:()=>P(s.id)})})}],[n,f]=c.useState([]),[N,F]=c.useState(0),C=T(s=>s.user.userInfo.id),[u]=V(),m=u.get("goodsId"),h=u.get("consumerId"),x=u.get("sellerId"),[o,v]=c.useState({role:2,pageSize:10,pageNum:1,type:m?"goods":h?"consumer":x?"seller":"",search:m||h||x||""});c.useEffect(()=>{async function s(){const p=await q(o);f(p.data.list),F(p.data.total)}s()},[o]);const P=async s=>{const y=await K({orderId:s,sellerId:C});if(y.status===200){S.success("该订单已发货");const k=n.map(I=>I.id===s?{...I,status:3}:I);f(k)}else S.error(y.desc)},[r]=a.useForm(),l=s=>{if(!r.getFieldValue(s))return z();v({...o,search:r.getFieldValue(s),type:s})},z=()=>{r.setFieldValue("goods",""),r.setFieldValue("seller",""),r.setFieldValue("consumer",""),v({...o,search:"",type:""})};return e.jsx("div",{children:e.jsxs(E,{title:"订单列表",style:{marginBottom:20},children:[e.jsxs(a,{initialValues:{},form:r,children:[e.jsxs("div",{className:"search-box",children:[e.jsx(a.Item,{label:"按商品查询",name:"goods",children:e.jsx(g,{className:"search",placeholder:"输入商品id",allowClear:!0,onPressEnter:()=>l("goods")})}),e.jsx(a.Item,{children:e.jsx(d,{type:"primary",icon:e.jsx(j,{}),shape:"circle",className:"but",onClick:()=>l("goods")})})]}),e.jsxs("div",{className:"search-box",children:[e.jsx(a.Item,{label:"按用户查询",name:"consumer",children:e.jsx(g,{className:"search",placeholder:"输入用户id",allowClear:!0,onPressEnter:()=>l("consumer")})}),e.jsx(a.Item,{children:e.jsx(d,{type:"primary",icon:e.jsx(j,{}),shape:"circle",className:"but",onClick:()=>l("consumer")})})]}),e.jsxs("div",{className:"search-box",children:[e.jsx(a.Item,{label:"按销售人员查询",name:"seller",children:e.jsx(g,{className:"search",placeholder:"输入销售人员id",allowClear:!0,onPressEnter:()=>l("seller")})}),e.jsx(a.Item,{children:e.jsx(d,{type:"primary",icon:e.jsx(j,{}),shape:"circle",className:"but",onClick:()=>l("seller")})})]})]}),e.jsx(A,{rowKey:"id",columns:i,dataSource:n,pagination:{total:N,pageSize:o.pageSize}})]})})};export{Q as default};
