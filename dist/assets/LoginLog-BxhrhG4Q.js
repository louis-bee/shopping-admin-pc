import{ag as f,u as R,r as n,F as r,a as v,j as e,C as b,I as N,B as c,R as E,P as j,b as V,c as z,ad as I}from"./index-DbKjKfQh.js";import{R as i,F as A,T as d}from"./index-wdfp5rx4.js";import{S as k}from"./index-Bxnr9kBO.js";import{R as B}from"./DeleteOutlined-D_9JrGLN.js";function O(t){return f({url:"log/getLoginLogList",method:"POST",data:t})}function $(t){return f({url:"log/delLoginLog",method:"POST",data:t})}const D=()=>{R();const t={1:e.jsx(d,{color:"warning",children:"用户"}),2:e.jsx(d,{color:"success",children:"销售人员"}),3:e.jsx(d,{color:"processing",children:"管理人员"})},L=[{title:"id",dataIndex:"id",width:70},{title:"账号id",dataIndex:"userId"},{title:"账号",dataIndex:"account"},{title:"用户名",dataIndex:"userName"},{title:"角色",dataIndex:"role",render:s=>t[s]},{title:"登录时间",dataIndex:"loginTime"},{title:"登出时间",dataIndex:"logoutTime"},{title:"操作",render:s=>e.jsxs(k,{size:"middle",children:[e.jsx(j,{content:"查看操作日志",placement:"top",children:e.jsx(c,{type:"primary",shape:"circle",icon:e.jsx(V,{}),onClick:()=>w(s.userId)})}),e.jsx(z,{title:"删除日志",description:"确认要删除该条日志吗?",onConfirm:()=>T(s.id),okText:"确认",cancelText:"取消",children:e.jsx(j,{content:"删除日志",placement:"right",children:e.jsx(c,{type:"primary",danger:!0,shape:"circle",icon:e.jsx(B,{})})})})]})}],[u,m]=n.useState([]),[y,P]=n.useState(0),[a,x]=n.useState({search:"",role:1});n.useEffect(()=>{async function s(){const l=await O(a);m(l.data.list||[]),P(l.data.total)}s()},[a]);const[o]=r.useForm(),h=()=>{console.log(o.role),x({...a,role:o.getFieldValue("role"),search:""})},g=()=>{x({...a,role:o.getFieldValue("role"),search:o.getFieldValue("search")})},S=v(s=>s.user.userInfo.id),T=async s=>{const p=await $({logId:s,adminId:S});if(p.status===200){I.success("已删除一条日志");const C=u.filter(F=>F.id!==s);m(C)}else I.error(p.desc)},w=s=>{console.log(s)};return e.jsx("div",{children:e.jsxs(b,{title:"登录日志",children:[e.jsxs(r,{initialValues:{role:1},form:o,onFinish:g,children:[e.jsx(r.Item,{label:"角色",name:"role",children:e.jsxs(i.Group,{onChange:h,children:[e.jsx(i,{value:1,children:"用户"}),e.jsx(i,{value:2,children:"销售人员"}),e.jsx(i,{value:3,children:"管理人员"})]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(r.Item,{label:"搜索",name:"search",children:e.jsx(N,{className:"search",placeholder:"输入用户id",allowClear:!0,onPressEnter:g,onClear:h})}),e.jsx(r.Item,{children:e.jsx(c,{type:"primary",htmlType:"submit",icon:e.jsx(E,{}),shape:"circle",className:"but"})})]})]}),e.jsx(A,{rowKey:"id",columns:L,dataSource:u,pagination:{total:y,pageSize:a.pageSize}})]})})};export{D as default};
