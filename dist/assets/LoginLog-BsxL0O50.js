import{r as I,b as w,a as n,F as o,u as C,j as e,C as R,I as b,B as p,R as v,d as N,P as E,s as j}from"./index-DgsCbQfb.js";import{R as i,F as V,T as c}from"./index-DEZmM0Pr.js";import{S as z}from"./index-DyYH2x0X.js";import{R as A}from"./DeleteOutlined-RYsHWtxa.js";function B(t){return I({url:"log/getLoginLogList",method:"POST",data:t})}function O(t){return I({url:"log/delLoginLog",method:"POST",data:t})}const M=()=>{w();const t={1:e.jsx(c,{color:"warning",children:"用户"}),2:e.jsx(c,{color:"success",children:"销售人员"}),3:e.jsx(c,{color:"processing",children:"管理人员"})},f=[{title:"id",dataIndex:"id",width:70},{title:"账号id",dataIndex:"userId"},{title:"账号",dataIndex:"account"},{title:"用户名",dataIndex:"userName"},{title:"角色",dataIndex:"role",render:s=>t[s]},{title:"登录时间",dataIndex:"loginTime"},{title:"登出时间",dataIndex:"logoutTime"},{title:"操作",render:s=>e.jsx(z,{size:"middle",children:e.jsx(N,{title:"删除日志",description:"确认要删除该条日志吗?",onConfirm:()=>T(s.id),okText:"确认",cancelText:"取消",children:e.jsx(E,{content:"删除日志",placement:"right",children:e.jsx(p,{type:"primary",danger:!0,shape:"circle",icon:e.jsx(A,{})})})})})}],[d,u]=n.useState([]),[L,P]=n.useState(0),[a,m]=n.useState({search:"",role:1});n.useEffect(()=>{async function s(){const l=await B(a);u(l.data.list||[]),P(l.data.total)}s()},[a]);const[r]=o.useForm(),h=()=>{console.log(r.role),m({...a,role:r.getFieldValue("role"),search:""})},x=()=>{m({...a,role:r.getFieldValue("role"),search:r.getFieldValue("search")})},S=C(s=>s.user.userInfo.id),T=async s=>{const g=await O({logId:s,adminId:S});if(g.status===200){j.success("已删除一条日志");const y=d.filter(F=>F.id!==s);u(y)}else j.error(g.desc)};return e.jsx("div",{children:e.jsxs(R,{title:"登录日志",children:[e.jsxs(o,{initialValues:{role:1},form:r,onFinish:x,children:[e.jsx(o.Item,{label:"角色",name:"role",children:e.jsxs(i.Group,{onChange:h,children:[e.jsx(i,{value:1,children:"用户"}),e.jsx(i,{value:2,children:"销售人员"}),e.jsx(i,{value:3,children:"管理人员"})]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(o.Item,{label:"搜索",name:"search",children:e.jsx(b,{className:"search",placeholder:"输入用户id",allowClear:!0,onPressEnter:x,onClear:h})}),e.jsx(o.Item,{children:e.jsx(p,{type:"primary",htmlType:"submit",icon:e.jsx(v,{}),shape:"circle",className:"but"})})]})]}),e.jsx(V,{rowKey:"id",columns:f,dataSource:d,pagination:{total:L,pageSize:a.pageSize}})]})})};export{M as default};
